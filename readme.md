Тихонов Тимофей Павлович БПИ212 ОС ИДЗ 2 ВАРИАНТ 19.
Применение семафоров для организации взаимодействия параллельных процессов.

Задача о болтунах. N болтунов имеют телефоны. Они либо ждут
звонков, либо звонят друг другу, чтобы побеседовать. Выбор этого состояния осуществляется случайно и равновероятно. Если телефон случайного абонента занят, болтун будет звонить другому
абоненту, пока ему кто-нибудь не ответит. Побеседовав некоторое
время, болтун равновероятно или ждет звонка, или звонит на другой случайный номер. Создать приложение, моделирующее
поведение болтунов. Каждый болтун — отдельный процесс.

на 4 (for_4/semVer2.c):
Использую неименованный Posix семафор "sem_lock" для и разделяемую память "/memory", процессы форкаются в функции main. Удаление семафоров и чистка памяти происходит в функции clean_up, которая вызывается служебной функцией at_exit(). Не понял как передавать туда аргументы, делать глобальным дескриптор не хотел, поэтому про запас повторил вызовы перед "return 0"

Итог:

Отлично получилось разделить задачу на функции и по моему код получился неплохим и читаемым, оставил много комментариев, при этом конечно есть куда дорабатывать. at_exit() не работает должным образом и вызывает warning, количество болтунов можно задавать не через define. Конечно еще можно доработать на 5-6, при этом именованные семафоры и SystemV для меня оказались трудноваты для понимания, решил не вставлять мои эксперименты в репозиторий, хотя под общую структуру программы я думаю они встанут хорошо.

PS для удобной демонстрации есть script.sh